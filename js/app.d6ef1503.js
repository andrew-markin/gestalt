(()=>{var e={477:()=>{},4174:e=>{"use strict";e.exports=JSON.parse('{"_LOCALE_TITLE":"English","APP_LANGUAGE":"Application language","CLONE_GESTALT":"Clone gestalt","CLOSE_DIALOG":"Close","COPY_LINK":"Copy link","DELETE_TASK":"Delete","DESCRIPTION_LENGTH_LIMIT_MESSAGE":"Description must be less than or equal to 256 characters","DESCRIPTION_REQUIRED_MESSAGE":"Description is required","DESCRIPTION":"Description","GESTALT":"Gestalt","GITHUB_REPOSITORY":"GitHub repository","LINKEDIN_PROFILE":"LinkedIn profile","NEW_GESTALT":"New gestalt","RESET_ALL_TASKS":"Reset all tasks","SAVE_DIALOG":"Save","SUBTASK":"Subtask","TASK_STATE_COMPLETE":"Complete","TASK_STATE_IN_PROGRESS":"In Progress","TASK_STATE_SET":"Set","TASK":"Task","TITLE_LENGTH_LIMIT_MESSAGE":"Title must be less than or equal to 64 characters","TITLE":"Title","TOGGLE_COLOR_THEME":"Toggle color theme","UNTITLED":"Untitled"}')},4600:e=>{"use strict";e.exports=JSON.parse('{"_LOCALE_TITLE":"Русский","APP_LANGUAGE":"Язык приложения","CLONE_GESTALT":"Клонировать гештальт","CLOSE_DIALOG":"Закрыть","COPY_LINK":"Скопировать ссылку","DELETE_TASK":"Удалить","DESCRIPTION_LENGTH_LIMIT_MESSAGE":"Описание должно быть не больше 256 символов","DESCRIPTION_REQUIRED_MESSAGE":"Описание не может быть пустым","DESCRIPTION":"Описание","GESTALT":"Гештальт","GITHUB_REPOSITORY":"Репозиторий на GitHub","LINKEDIN_PROFILE":"Профиль на LinkedIn","NEW_GESTALT":"Новый гештальт","RESET_ALL_TASKS":"Перепоставить все задачи","SAVE_DIALOG":"Сохранить","SUBTASK":"Подзадача","TASK_STATE_COMPLETE":"Завершена","TASK_STATE_IN_PROGRESS":"Выполняется","TASK_STATE_SET":"Поставлена","TASK":"Задача","TITLE_LENGTH_LIMIT_MESSAGE":"Название должно быть не больше 64 символов","TITLE":"Название","TOGGLE_COLOR_THEME":"Поменять цветовую тему","UNTITLED":"Без названия"}')},4649:(e,t,s)=>{var a={"./en.json":4174,"./ru.json":4600};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}n.keys=function(){return Object.keys(a)},n.resolve=r,e.exports=n,n.id=4649},9965:(e,t,s)=>{"use strict";s(6573),s(8100),s(7936),s(9577),s(1549),s(9797),s(9631),s(5623);var a=s(5364),n=s.n(a),r=s(955),i=s.n(r),o=s(9021),l=s.n(o),d=s(3793),c=s.n(d),u=s(3075),k=s(7852);const f="dTQh12Ao8KnoIKJyvvPVXq3yyYeTej71",p=e=>{const t=e.length,s=[];for(let a=0;a<t;a++)s[a>>>2]|=e[a]<<24-a%4*8;return l().lib.WordArray.create(s,e.length)},m=e=>{const t=e.words,s=e.sigBytes,a=new Uint8Array(s);for(let n=0;n<s;n++)a[n]=t[n>>>2]>>>24-n%4*8&255;return a},v=n()("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),h=()=>{const e=l().lib.WordArray.random(32);return v.encode(m(e))},T=e=>c()(e,f).toString(),_=(e,t)=>{if(!e)return;const s=p(u.Ay.deflate(e));return i().encrypt(s,t).toString()},g=(e,t)=>{if(!e)return;const s=m(i().decrypt(e,t));return u.Ay.inflate(s,{to:"string"})};let y=0;const A=()=>1e3*(Date.now()+y)+Math.floor(1e3*Math.random()),E=e=>{y=e},S=e=>{const t=e.target,s=t.value.length;t.setSelectionRange(s,s)};k.Ay.prototype.$moveCursorToEnd=S;var b=s(5668),w=s(4311),L=s(4112),x=s(430),I=s(7314),C=s(374),O=s(6930),D=s(5322),P=s(7683),$=s(1034),N=function(){var e=this,t=e._self._c;return t(b.A,{key:e.$i18n.locale},[t(w.A,{attrs:{id:"bar",app:"",short:"",flat:"",color:"foreground"}},[t(C.A,{staticClass:"d-flex py-0 noselect overflow-x-hidden"},[t(L.A,{staticClass:"mr-3",attrs:{size:"32"}},[t("div",{attrs:{id:"favicon"}},[t("object",{attrs:{type:"image/svg+xml",data:"favicon.svg",width:"100%",height:"100%"}})])]),t("div",{staticClass:"d-flex align-center text-h5 overflow-x-hidden pr-4",attrs:{id:"title"},on:{click:function(t){return e.setPrefsDialogShown(!0)}}},[t("span",{staticClass:"font-weight-medium mr-2"},[e._v(e._s(e.$t("GESTALT"))+":")]),t("span",{staticClass:"text-truncate",class:{"muted-1":!e.title}},[e._v(" "+e._s(e.title||e.$t("UNTITLED"))+" ")]),t(x.A,{staticClass:"ml-2",attrs:{dot:"","offset-y":"-6",value:!e.synced}})],1),t($.A),t(I.A,{staticClass:"ml-2",attrs:{depressed:""},on:{click:function(t){return e.demandTask({})}}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiPlus))]),e._v(" "+e._s(e.$t("TASK"))+" ")],1),t(I.A,{staticClass:"ml-2",attrs:{depressed:"",disabled:!e.selectedTask},on:{click:function(t){return e.demandTask({subtask:!0})}}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiPlus))]),e._v(" "+e._s(e.$t("SUBTASK"))+" ")],1),t(P.A,{attrs:{transition:"slide-y-transition","offset-y":"","content-class":"rounded-lg","min-width":"300"},scopedSlots:e._u([{key:"activator",fn:function({on:s,attrs:a}){return[t(I.A,e._g(e._b({staticClass:"nominwidth pa-2 ml-2",attrs:{depressed:""}},"v-btn",a,!1),s),[t(O.A,[e._v(e._s(e.mdiMenu))])],1)]}}])},[t("app-menu-list")],1)],1)],1),t("prefs-dialog"),t("task-dialog"),t(D.A,{staticClass:"background"},[t("router-view")],1)],1)},G=[],K=s(9165),R=s(5353),M=s(9483),U=s(8983),V=s(7296),H=s(9872),j=s(3302),B=function(){var e=this,t=e._self._c;return t(U.A,[t(V.A,{attrs:{link:""},on:{click:e.copyLink}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiLinkVariant))]),e._v(" "+e._s(e.$t("COPY_LINK"))+" ")],1),t(V.A,{attrs:{link:""},on:{click:e.newGestalt}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiOpenInNew))]),e._v(" "+e._s(e.$t("NEW_GESTALT"))+" ")],1),t(V.A,{attrs:{link:""},on:{click:e.cloneGestalt}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiContentDuplicate))]),e._v(" "+e._s(e.$t("CLONE_GESTALT"))+" ")],1),t(V.A,{attrs:{link:""},on:{click:e.resetAllTasks}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiCircleOutline))]),e._v(" "+e._s(e.$t("RESET_ALL_TASKS"))+" ")],1),t(V.A,{attrs:{link:""},on:{click:e.toggleDarkTheme}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiInvertColors))]),e._v(" "+e._s(e.$t("TOGGLE_COLOR_THEME"))+" ")],1),t(M.A),t(j.A,[e._v(" "+e._s(e.$t("APP_LANGUAGE"))+" ")]),t(H.A,{model:{value:e.$i18n.locale,callback:function(t){e.$set(e.$i18n,"locale",t)},expression:"$i18n.locale"}},e._l(e.$i18n.availableLocales,function(s){return t(V.A,{key:s,attrs:{value:s}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiTranslate))]),e._v(" "+e._s(e.$t("_LOCALE_TITLE",s))+" ")],1)}),1),t(M.A),t(V.A,{attrs:{href:e.github,target:"_blank"}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiGithub))]),e._v(" "+e._s(e.$t("GITHUB_REPOSITORY"))+" ")],1),t(V.A,{attrs:{href:e.linkedin,target:"_blank"}},[t(O.A,{attrs:{left:""}},[e._v(e._s(e.mdiLinkedin))]),e._v(" "+e._s(e.$t("LINKEDIN_PROFILE"))+" ")],1)],1)},F=[];const q="https://github.com/andrew-markin/gestalt",Y="https://www.linkedin.com/in/andrew-markin-08396831";var J=s(3971);const z={primary:"#5C6BC0",success:"#66BB6A",error:"#F44336",pipe:"#9E9E9E"},W={...z,background:"#E5E5E5",foreground:"#FFFFFF",border:"#DADADA",hover:"#F6F7FB"},Q={...z,background:"#1E1E1E",foreground:"#2C2C2C",border:"#444444",hover:"#2E2F33"};k.Ay.use(J.A);let X=!1;const Z=matchMedia&&matchMedia("(prefers-color-scheme: dark)");Z&&(X=Z.matches,Z.addEventListener("change",({matches:e})=>{X=e,se()}));const ee="dark",te=()=>{const e=localStorage.getItem(ee);return null!==e?"true"===e:X},se=()=>{ne.framework.theme.dark=te()},ae=()=>{const e=!ne.framework.theme.dark;e!==X?localStorage.setItem(ee,e):localStorage.removeItem(ee),se()},ne=new J.A({icons:{iconfont:"mdiSvg"},theme:{themes:{light:W,dark:Q},options:{customProperties:!0},dark:te()},breakpoint:{thresholds:{xs:576,sm:768,md:992,lg:1200}}}),re=ne,ie={data:()=>({github:q,linkedin:Y,mdiLinkVariant:K.YBz,mdiOpenInNew:K.gs2,mdiContentDuplicate:K.rt5,mdiCircleOutline:K.h$D,mdiInvertColors:K.Z36,mdiTranslate:K.VPl,mdiGithub:K.ktP,mdiLinkedin:K.NCK}),methods:{...(0,R.i0)(["copyLink","newGestalt","cloneGestalt","resetAllTasks"]),toggleDarkTheme:ae}},oe=ie;var le=s(1656),de=(0,le.A)(oe,B,F,!1,null,null,null);const ce=de.exports;var ue=s(1484),ke=s(1289),fe=s(174),pe=s(7283),me=function(){var e=this,t=e._self._c;return t(ke.A,{attrs:{"max-width":"650","overlay-color":"grey darken-3"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t(ue.A,{staticClass:"pa-5 rounded-lg"},[t("span",{staticClass:"text-h5"},[e._v(e._s(e.$t("GESTALT")))]),t(fe.A,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(pe.A,{staticClass:"my-5",attrs:{outlined:"",autofocus:"",label:e.$t("TITLE"),placeholder:e.$t("UNTITLED"),rules:e.titleRules,counter:"64"},on:{focus:e.$moveCursorToEnd,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.$refs.saveButton.$el.click())}},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),t("div",{staticClass:"d-flex"},[t($.A),t(I.A,{staticClass:"mr-3",attrs:{depressed:""},on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("CLOSE_DIALOG"))+" ")]),t(I.A,{ref:"saveButton",attrs:{depressed:"",color:"primary",disabled:!e.visible||!e.valid||!e.modified},on:{click:e.save}},[e._v(" "+e._s(e.$t("SAVE_DIALOG"))+" ")])],1)],1)],1)},ve=[];const he={data:()=>({title:"",valid:!0}),computed:{...(0,R.aH)(["prefsDialogShown"]),...(0,R.L8)(["getPref"]),visible:{get(){return!!this.prefsDialogShown},set(e){e||this.setPrefsDialogShown(!1)}},titleRules(){return[e=>e.length<=64||this.$t("TITLE_LENGTH_LIMIT_MESSAGE")]},savedTitle(){return this.getPref("title")},trimmedTitle(){return this.title.trim()||void 0},modified(){return this.trimmedTitle!==this.savedTitle}},watch:{prefsDialogShown(e){this.title=e&&this.savedTitle||"",this.$refs.form&&this.$refs.form.resetValidation()}},methods:{...(0,R.i0)(["setPref"]),...(0,R.PY)(["setPrefsDialogShown"]),async save(){this.visible&&this.modified&&this.$refs.form.validate()&&(await this.setPref({name:"title",value:this.trimmedTitle}),this.visible=!1)}}},Te=he;var _e=(0,le.A)(Te,me,ve,!1,null,null,null);const ge=_e.exports;var ye=s(6513),Ae=function(){var e=this,t=e._self._c;return t(ke.A,{attrs:{"max-width":"650","overlay-color":"grey darken-3"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t(ue.A,{staticClass:"pa-5 rounded-lg"},[t("div",{staticClass:"d-flex align-center"},[t("span",{staticClass:"text-h5"},[e._v(e._s(e.$t("TASK")))]),t($.A),t("task-state-input",{model:{value:e.state,callback:function(t){e.state=t},expression:"state"}})],1),t(fe.A,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(ye.A,{staticClass:"my-5",attrs:{outlined:"",autofocus:"",label:e.$t("DESCRIPTION"),rows:"6","no-resize":"",counter:"256",required:"",rules:e.descriptionRules},on:{focus:e.$moveCursorToEnd,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),void(e.description+="\n")):null},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:(t.preventDefault(),e.$refs.saveButton.$el.click())}]},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1),t("div",{staticClass:"d-flex"},[t(I.A,{attrs:{depressed:""},on:{click:function(t){return e.deleteTask(e.task.uuid)}}},[e._v(" "+e._s(e.$t("DELETE_TASK"))+" ")]),t($.A),t(I.A,{staticClass:"mr-3",attrs:{depressed:""},on:{click:function(t){e.visible=!1}}},[e._v(" "+e._s(e.$t("CLOSE_DIALOG"))+" ")]),t(I.A,{ref:"saveButton",attrs:{depressed:"",color:"primary",disabled:!e.visible||!e.valid||!e.modified},on:{click:e.save}},[e._v(" "+e._s(e.$t("SAVE_DIALOG"))+" ")])],1)],1)],1)},Ee=[],Se=function(){var e=this,t=e._self._c;return t("div",{staticClass:"d-inline"},e._l(e.states,function(s){return t(I.A,{key:s.value,staticClass:"ml-1",class:{"muted-1":s.value!==e.value},attrs:{depressed:"",rounded:"",color:s.value===e.value&&s.color||void 0,text:s.value!==e.value},on:{click:function(t){e.$emit("input",s.value)&&e.blur()}}},[e._v(" "+e._s(s.title)+" "),t(O.A,{attrs:{right:""}},[e._v(e._s(s.icon))])],1)}),1)},be=[];const we={Set:0,InProgress:1,Complete:2},Le={props:{value:{type:Number,default:0}},computed:{states(){return[{value:we.Set,title:this.$t("TASK_STATE_SET"),icon:K.h$D,color:void 0},{value:we.InProgress,title:this.$t("TASK_STATE_IN_PROGRESS"),icon:K.$IL,color:"primary"},{value:we.Complete,title:this.$t("TASK_STATE_COMPLETE"),icon:K.jwx,color:"success"}]},blur(){let e=this.$el.parentElement;while(e&&"0"!==e.getAttribute("tabindex"))e=e.parentElement;return()=>{e&&e.focus()}}}},xe=Le;var Ie=(0,le.A)(xe,Se,be,!1,null,null,null);const Ce=Ie.exports,Oe={components:{TaskStateInput:Ce},data:()=>({description:"",state:0,valid:!0}),computed:{...(0,R.aH)(["demandedTask"]),...(0,R.L8)(["getTask"]),visible:{get(){return!!this.demandedTask},set(e){e||this.demandTask()}},descriptionRules(){return[e=>!!e&&e.trim().length>0||this.$t("DESCRIPTION_REQUIRED_MESSAGE"),e=>e.length<=256||this.$t("DESCRIPTION_LENGTH_LIMIT_MESSAGE")]},task(){const{uuid:e}=this.demandedTask||{};return this.getTask(e)},trimmedDescription(){return this.description.trim()},modified(){if(!this.task)return!0;if(!this.task.data)return!1;const{description:e,state:t}=this.task.data;return this.trimmedDescription!==e||this.state!==t}},watch:{demandedTask(){if(this.task){const{description:e,state:t}=this.task.data||{};this.description=e||"",this.state=t||0}else this.description="",this.state=0;this.$refs.form&&this.$refs.form.resetValidation()}},methods:{...(0,R.i0)(["upsertTask","deleteTask"]),...(0,R.PY)(["demandTask"]),async save(){if(!this.demandedTask||!this.modified||!this.$refs.form.validate())return;const{uuid:e,subtask:t}=this.demandedTask;await this.upsertTask({uuid:e,subtask:t,data:{description:this.trimmedDescription,state:this.state}}),this.visible=!1}}},De=Oe;var Pe=(0,le.A)(De,Ae,Ee,!1,null,null,null);const $e=Pe.exports;s(8111),s(7588);var Ne=s(4765);k.Ay.use(Ne.A);const Ge={},Ke=s(4649);Ke.keys().forEach(e=>{const t=e.match(/([A-Za-z0-9-_]+)\./i);if(t&&t.length>1){const s=t[1];Ge[s]=Ke(e)}});const Re=e=>e&&e.trim().split(/-|_/)[0],Me=Re(void 0!==navigator.languages?navigator.languages[0]:navigator.language),Ue="locale",Ve=e=>{e!==Me?localStorage.setItem(Ue,e):localStorage.removeItem(Ue)},He=new Ne.A({locale:localStorage.getItem(Ue)||Me||"en",fallbackLocale:"en",messages:Ge}),je={components:{AppMenuList:ce,PrefsDialog:ge,TaskDialog:$e},data:()=>({mdiPlus:K.biz,mdiMenu:K.ExW}),computed:{...(0,R.aH)(["selectedTask"]),...(0,R.L8)(["synced","getPref"]),title(){return this.getPref("title")}},watch:{title(){this.updateTitle()},"$i18n.locale":function(e){Ve(e),this.updateTitle()}},methods:{...(0,R.PY)(["setPrefsDialogShown","demandTask"]),updateTitle(){document.title=`${this.$t("GESTALT")}: ${this.title||this.$t("UNTITLED")}`}},created(){this.updateTitle()}},Be=je;var Fe=(0,le.A)(Be,N,G,!1,null,"4254a27c",null);const qe=Fe.exports;var Ye=s(173),Je=function(){var e=this,t=e._self._c;return t(C.A,{staticClass:"pt-0"},[t("div",{attrs:{id:"outside"},on:{click:function(t){return e.select()}}}),t("task-tree",{staticClass:"noselect",attrs:{tasks:e.tasks,"selected-task":e.selectedTask},on:{open:e.open,move:e.move,reorder:e.reorder,expand:e.expand,select:e.select}})],1)},ze=[],We=s(8184),Qe=function(){var e=this,t=e._self._c;return t("drop-list",{class:{"mt-3":!e.parent,hoverable:!e.dragInProgress},attrs:{items:e.tasks,column:"","no-animations":""},on:{insert:function(t){return e.$emit("move",t.data,e.parent,t.index)},reorder:function(t){return e.$emit("reorder",e.parent,t.from,t.to)}},scopedSlots:e._u([{key:"item",fn:function({item:s,index:a}){return[t("drag",{key:s.uuid,attrs:{data:s.uuid,"drag-image-opacity":.9},on:{dragstart:function(t){return e.$emit("select",s.uuid)}},scopedSlots:e._u([s.deleted?null:{key:"default",fn:function(){return[t("div",{staticClass:"d-flex"},[e.parent?t("div",{staticClass:"trunk mt-n3",class:{piped:e.tasks.length-a>1}},[t("div",{staticClass:"bridge pt-3",class:{last:e.tasks.length-a===1}})]):e._e(),t("div",{staticClass:"flex-grow-1 overflow-hidden"},[t(We.A,{staticClass:"task rounded mb-3 px-3 d-flex",class:{primary:s.uuid===e.selectedTask},attrs:{tabindex:"0",dark:s.uuid===e.selectedTask},on:{focus:function(t){return e.$emit("select",s.uuid)},dblclick:function(t){return e.$emit("open",s.uuid)}}},[s.subtasks.length>0?t("div",{staticClass:"expander ml-n3 d-flex justify-center",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.$emit("expand",s.uuid)},dblclick:function(e){e.preventDefault(),e.stopPropagation()}}},[t(O.A,[e._v(" "+e._s(s.expanded?e.mdiChevronUp:e.mdiChevronDown)+" ")])],1):e._e(),t("div",{staticClass:"d-flex flex-grow-1 align-center overflow-hidden"},[t("span",{staticClass:"text-body-1 text-truncate"},[e._v(" "+e._s(s.data.description)+" ")])]),t("div",{staticClass:"ml-3 d-flex align-center"},[t("task-state-icon",{attrs:{state:s.state}})],1),t("drop",{staticClass:"drop-area",on:{drop:function(t){return e.$emit("move",t.data,s.uuid)}}})],1),s.subtasks.length>0&&s.expanded?t("task-tree",e._g({attrs:{parent:s.uuid,tasks:s.subtasks,"selected-task":e.selectedTask}},e.$listeners)):e._e()],1)])]},proxy:!0},{key:"drag-image",fn:function(){return[t(We.A,{staticClass:"primary dragged rounded pa-2 d-flex align-center noselect",attrs:{dark:""}},[t("span",{staticClass:"text-body-1 text-truncate"},[e._v(" "+e._s(s.data.description)+" ")])])]},proxy:!0}],null,!0)})]}},{key:"feedback",fn:function({data:s}){return[t("div",{key:s,staticClass:"feedback",class:{shrinked:!!e.parent}})]}},{key:"reordering-feedback",fn:function(){return[t("div",{key:"feedback",staticClass:"feedback",class:{shrinked:!!e.parent}})]},proxy:!0}])})},Xe=[],Ze=s(6020),et=function(){var e=this,t=e._self._c;return t(O.A,{class:{"muted-2":e.muted}},[e._v(" "+e._s(e.icon)+" ")])},tt=[];const st={props:{state:{type:Number,default:we.Set}},computed:{icon(){switch(this.state){case we.Set:return K.h$D;case we.InProgress:return K.$IL;case we.Complete:return K.jwx;default:return}},muted(){return this.state===we.Set}}},at=st;var nt=(0,le.A)(at,et,tt,!1,null,null,null);const rt=nt.exports,it={name:"task-tree",mixins:[Ze.gl],components:{Drag:Ze.X0,Drop:Ze.ey,DropList:Ze.kt,DragAwareMixin:Ze.gl,TaskStateIcon:rt},props:{parent:{type:String},tasks:{type:Array,default:()=>[]},selectedTask:{type:String}},data:()=>({mdiChevronDown:K.W5x,mdiChevronUp:K.Fb5})},ot=it;var lt=(0,le.A)(ot,Qe,Xe,!1,null,"258d70c7",null);const dt=lt.exports,ct={components:{TaskTree:dt},computed:{...(0,R.aH)(["tasks","selectedTask"]),gestaltKey(){return this.$route.params.key}},watch:{gestaltKey(){this.loadGestalt()}},methods:{...(0,R.i0)(["load","moveTask","reorderTask","expandTask","selectTask"]),...(0,R.PY)(["demandTask"]),loadGestalt(){this.load(this.gestaltKey)},open(e){this.selectTask(e),this.demandTask({uuid:e})},move(e,t,s){this.moveTask({uuid:e,target:t,index:s})},reorder(e,t,s){this.reorderTask({parent:e,from:t,to:s})},expand(e){this.selectTask(e),this.expandTask(e)},select(e){this.selectTask(e)}},mounted(){this.loadGestalt()}},ut=ct;var kt=(0,le.A)(ut,Je,ze,!1,null,"5ec7b668",null);const ft=kt.exports;k.Ay.use(Ye.Ay);const pt=new Ye.Ay({routes:[{name:"board",path:"/:key([a-zA-Z0-9]{43})",component:ft},{path:"*",redirect:{name:"board",params:{key:h()}}}]});s(4114),s(8237),s(3110),s(8335),s(4603),s(7566);var mt=s(129),vt=s(7965),ht=s.n(vt),Tt=s(4787),_t=s(2302);s(116),s(1701);const gt=e=>e.map(({name:e,value:t,changed:s})=>({name:e,value:t,changed:s})),yt=(e,t)=>{const s=e.find(e=>e.name===t)||{};return s.value},At=(e,t,s)=>{const a=A(),n=e.find(e=>e.name===t);n?(n.value=s,n.changed=a):e.push({name:t,value:s,changed:a})},Et=(e,t)=>{const s=new Map;for(const a of e||[])s.set(a.name,a);for(const a of t||[]){const e=s.get(a.name);(!e||a.changed>e.changed)&&s.set(a.name,a)}return Array.from(s.values())},St={unify:gt,getValue:yt,setValue:At,merge:Et};s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);const bt=e=>e.map(({uuid:e,subtasks:t,expanded:s,deleted:a,state:n,...r})=>({uuid:e||(0,_t.A)(),subtasks:bt(t||[]),expanded:s||!1,deleted:a||!1,state:void 0,...r})),wt=(e,t=!1)=>e.map(({subtasks:e,expanded:s,deleted:a,created:n,state:r,...i})=>({...e.length>0&&{subtasks:wt(e,t)},...!t&&s&&{expanded:s},...!t&&a&&{deleted:a},...!t&&n&&{created:n},...i})),Lt=(e,t)=>{if(!e||!t)return;let s=e,a=0;const n=[];let r,i;while(s){if(a>=s.length){[s,a]=n.pop()||[];continue}const e=s[a];if(e.deleted)a+=1;else{if(i)return{...i,next:e.uuid};e.uuid===t?i={task:e,tasks:s,index:a,previous:r}:r=e.uuid,a+=1,e.subtasks.length>0&&e.expanded&&(n.push([s,a]),s=e.subtasks,a=0)}}return i},xt=(e,t)=>{if(!t)return e;const{task:s}=Lt(e,t);return s?s.subtasks||[]:void 0},It=e=>{for(const t of e){if(t.deleted)continue;It(t.subtasks);let e=t.data.state;for(const s of t.subtasks)if(!s.deleted){if(e===we.InProgress)break;if(e!==s.state){e=we.InProgress;break}}t.state=e}},Ct=(e,t)=>{const s=e=>{const t=new Map,s=e=>{for(const a of e||[])t.set(a.uuid,a),s(a.subtasks)};return s(e),t},a=s(e),n=s(t),r=new Set,i=(e,t)=>(e||0)>(t||0),o=(e,t)=>(e||0)>=(t||0),l={BOTH:0,LOCAL:1,REMOTE:2},d=(e,t)=>{const s=e||[],d=t||[];let u=0,k=0;const f=[],p=e=>{r.add(e),f.push(c(e))};while(1){const e=s[u],t=d[k];if(!e&&!t)break;let c;if(c=e?t?e.uuid===t.uuid?l.BOTH:o(t.moved,e.moved)?l.REMOTE:l.LOCAL:l.LOCAL:l.REMOTE,c===l.LOCAL){if(u++,r.has(e.uuid))continue;const t=n.get(e.uuid);if(t&&i(t.moved,e.moved))continue;p(e.uuid)}else if(c===l.REMOTE){if(k++,r.has(t.uuid))continue;const e=a.get(t.uuid);if(e&&i(e.moved,t.moved))continue;p(t.uuid)}else u++,k++,p(e.uuid)}return f},c=e=>{const t=a.get(e),s=n.get(e);if(t||s)return t?s?{...o(t.changed,s.changed)?t:s,moved:Math.max(t.moved||0,s.moved||0),subtasks:d(t.subtasks,s.subtasks),expanded:t.expanded,deleted:t.deleted}:{...t,subtasks:d(t.subtasks,void 0)}:{...s,subtasks:d(void 0,s.subtasks)}},u=e=>{const t=[];for(const s of e)s&&!s.deleted&&(s.created||n.has(s.uuid))&&(s.subtasks=u(s.subtasks),s.created=!1,t.push(s));return t};return u(d(e,t))},Ot=e=>{let t=0;for(const s of e)s.data.state!==we.Set&&(s.data.state=we.Set,t+=1),t+=Ot(s.subtasks);return t},Dt=(e,t)=>{const s=new Set,a=e=>{for(const t of e||[])t.expanded&&s.add(t.uuid),a(t.subtasks)},n=e=>{for(const t of e||[])s.has(t.uuid)&&(t.expanded=!0),n(t.subtasks)};a(e),n(t)},Pt={extend:bt,reduce:wt,findOne:Lt,findSubtasks:xt,recomputeStates:It,merge:Ct,resetAll:Ot,transferExpanded:Dt},$t=2e3,Nt=3e4,Gt=10;k.Ay.use(R.Ay);const Kt=(e,t)=>{const s=g(e,t),{prefs:a,tasks:n}=s&&JSON.parse(s)||{};return{prefs:St.unify(a||[]),tasks:Pt.extend(n||[])}},Rt=({prefs:e,tasks:t},s,a=!1)=>_(JSON.stringify({prefs:St.unify(e),tasks:Pt.reduce(t,a)}),s),Mt=(e,t)=>({prefs:St.merge(e.prefs,t.prefs),tasks:Pt.merge(e.tasks,t.tasks)}),Ut=e=>{const t=pt.resolve({name:"board",params:{key:e}});return new URL(t.href,window.location.href).href},Vt=(0,Tt.Ay)("wss://blobs.mayfleet.com",{transports:["websocket"],auth:{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJidWNrZXQiOiJnZXN0YWx0IiwiaWF0IjoxNjUwNzE0MzQ0fQ.-g7Kv8LgobhMNJ_nEUKcD0s7Ry4mNRnWxqTJXabwPYo"}});Vt.on("connect_error",e=>{console.warn("Socket connection error:",e.message)}),Vt.on("connect",async()=>{let e=Date.now();const{timestamp:t}=await Ht("now");e=Math.floor((e+Date.now())/2),E(t-e),Yt.dispatch("setupSocket")}),Vt.on("changed",()=>{Yt.dispatch("sync")});const Ht=(e,...t)=>new Promise((s,a)=>{if(!Vt.connected)return a(new Error("Socket is not connected"));Vt.emit(e,...t,e=>{const{error:t,...n}=e||{};t?a(new Error(t)):s(n)})}),jt=e=>new Promise(t=>{setTimeout(()=>{t()},e)});let Bt;const Ft=()=>{clearTimeout(Bt),Bt=setTimeout(()=>{Bt=void 0,Yt.dispatch("sync")},$t)};setInterval(()=>{Yt.dispatch("syncIfNeeded")},Nt);const qt=new mt.eu,Yt=new R.Ay.Store({state:{key:void 0,prefs:[],tasks:[],saved:!0,version:void 0,prefsDialogShown:!1,selectedTask:void 0,demandedTask:void 0},getters:{synced(e){return e.version||0===e.prefs.length&&0===e.tasks.length},getPref:e=>t=>St.getValue(e.prefs,t),getTask:e=>t=>{const{task:s}=Pt.findOne(e.tasks,t)||{};return s}},mutations:{setContext(e,{prefs:t,tasks:s}){e.prefs=t,e.tasks=s,Pt.recomputeStates(e.tasks),e.saved=!1},setKey(e,t){e.key=t},setSaved(e,t){e.saved=t},setVersion(e,t){e.version=t},setPref(e,{name:t,value:s}){St.setValue(e.prefs,t,s),e.saved=!1},setPrefsDialogShown(e,t=!0){e.prefsDialogShown=t},upsertTask(e,{uuid:t,subtask:s,data:a}){const n=A();if(t){const{task:s}=Pt.findOne(e.tasks,t)||{};if(!s)return;return s.data=a,s.changed=n,Pt.recomputeStates(e.tasks),void(e.saved=!1)}const r={data:a,uuid:(0,_t.A)(),changed:n,moved:n,subtasks:[],expanded:!1,deleted:!1,created:!0,state:void 0};if(!e.selectedTask)return e.tasks.push(r),Pt.recomputeStates(e.tasks),e.selectedTask=r.uuid,void(e.saved=!1);const{task:i,tasks:o,index:l}=Pt.findOne(e.tasks,e.selectedTask)||{};i&&(s?(i.subtasks.push(r),i.expanded=!0):o.splice(l+1,0,r),Pt.recomputeStates(e.tasks),e.selectedTask=r.uuid,e.saved=!1)},moveTask(e,{uuid:t,target:s,index:a}){if(t===s)return;const{task:n,...r}=Pt.findOne(e.tasks,t);if(!n||Pt.findOne(n.subtasks||[],s))return;let i;if(s){const{task:t}=Pt.findOne(e.tasks,s)||{};if(!t)return;t.expanded=!0,i=t.subtasks}else i=e.tasks;r.tasks.splice(r.index,1),void 0===a?i.push(n):i.splice(a,0,n),n.moved=A(),Pt.recomputeStates(e.tasks),e.saved=!1},reorderTask(e,{parent:t,from:s,to:a}){const n=Pt.findSubtasks(e.tasks,t);if(!n)return;const r=n.splice(s,1)[0];r.moved=A(),n.splice(a,0,r),e.saved=!1},deleteTask(e,t){if(!t)return;e?.demandedTask?.uuid===t&&(e.demandedTask=void 0);const s=Pt.findOne(e.tasks,t);s&&(s.task.deleted=!0,s.tasks.splice(s.index,1),e.tasks.push(s.task),Pt.recomputeStates(e.tasks),e.saved=!1,e.selectedTask===t&&(s.previous?e.selectedTask=s.previous:s.next?e.selectedTask=s.next:e.selectedTask=void 0))},resetAllTasks(e){0!==Pt.resetAll(e.tasks)&&(Pt.recomputeStates(e.tasks),e.saved=!1)},expandTask(e,t){const{task:s}=Pt.findOne(e.tasks,t)||{};s&&(s.expanded=!s.expanded)},selectTask(e,t){t&&!Pt.findOne(e.tasks,t)||(e.selectedTask=t)},demandTask(e,t){e.demandedTask=t}},actions:{async setupSocket({state:e,dispatch:t}){Vt.connected&&(await Ht("ref",T(e.key)),t("sync"))},async resetSocket(){Vt.connected&&await Ht("ref",void 0)},saveLocal({state:e},{name:t,value:s,key:a}){const n=`gestalt:${T(a||e.key)}:${t}`;void 0!==s?localStorage.setItem(n,s):localStorage.removeItem(n)},loadLocal({state:e},t){const s=`gestalt:${T(e.key)}:${t}`;return localStorage.getItem(s)||void 0},async load({commit:e,dispatch:t},s){const a=await qt.acquire();try{await t("resetSocket"),e("setKey",s),e("selectTask",void 0);const a=await t("loadLocal","data");e("setContext",Kt(a,s));const n=await t("loadLocal","version");e("setVersion",n);const r=await t("loadLocal","selected");e("selectTask",r),await t("setupSocket")}catch(n){console.warn("Unable to load state:",n.message)}finally{a()}},async save({state:e,dispatch:t,commit:s}){await t("saveLocal",{name:"data",value:Rt(e,e.key)}),s("setSaved",!0)},async saveIfNeeded({state:e,dispatch:t}){e.saved||(await t("save"),await t("setVersion",void 0),await t("saveSelectedTask"))},copyLink({state:e}){ht()(Ut(e.key))},newGestalt(){window.open(Ut(h()))},async cloneGestalt({state:e,dispatch:t}){const s=h();await t("saveLocal",{key:s,name:"data",value:Rt(e,s)}),window.open(Ut(s))},async resetAllTasks({commit:e,dispatch:t}){e("resetAllTasks"),await t("saveIfNeeded")},async setVersion({state:e,commit:t,dispatch:s},a){a||Ft(),e.version!==a&&(t("setVersion",a),await s("saveLocal",{name:"version",value:a}))},async syncIfNeeded({state:e,dispatch:t}){!Vt.connected||e.version||Bt||await t("sync")},async sync({state:e,getters:t,commit:s,dispatch:a}){if(clearTimeout(Bt),Bt=void 0,!Vt.connected)return;const n=await qt.acquire();try{let n,r,i=Gt,o=await Ht("get",{known:e.version});while(i-- >0){let s;if(o.data){if(o.context=Kt(o.data,e.key),e.version){e.version!==o.version&&(n=o.context,r=o.version);break}s=Mt(e,o.context)}else if(o.version===e.version&&t.synced)break;const a=Rt(s||e,e.key,!0);if(o=await Ht("set",{data:a,version:o.version}),o.success){n=s||void 0,r=o.version;break}await jt(200)}n&&(Pt.transferExpanded(e.tasks,n.tasks),s("setContext",n),await a("save")),r&&await a("setVersion",r)}catch(r){console.warn("Unable to sync:",r.message)}finally{n()}},async setPref({commit:e,dispatch:t},{name:s,value:a}){const n=await qt.acquire();try{e("setPref",{name:s,value:a}),await t("saveIfNeeded")}catch(r){console.warn("Unable to set preference:",r.message)}finally{n()}},async upsertTask({commit:e,dispatch:t},{uuid:s,subtask:a,data:n}){const r=await qt.acquire();try{e("upsertTask",{uuid:s,subtask:a,data:n}),await t("saveIfNeeded")}catch(i){console.warn("Unable to upsert task:",i.message)}finally{r()}},async moveTask({commit:e,dispatch:t},{uuid:s,target:a,index:n}){const r=await qt.acquire();try{e("moveTask",{uuid:s,target:a,index:n}),await t("saveIfNeeded")}catch(i){console.warn("Unable to move task:",i.message)}finally{r()}},async reorderTask({commit:e,dispatch:t},{parent:s,from:a,to:n}){const r=await qt.acquire();try{e("reorderTask",{parent:s,from:a,to:n}),await t("saveIfNeeded")}catch(i){console.warn("Unable to reorder task:",i.message)}finally{r()}},async deleteTask({commit:e,dispatch:t},s){const a=await qt.acquire();try{e("deleteTask",s),await t("saveIfNeeded")}catch(n){console.warn("Unable to delete task:",n.message)}finally{a()}},async expandTask({commit:e,dispatch:t},s){if(!s)return;const a=await qt.acquire();try{e("expandTask",s),await t("save")}catch(n){console.warn("Unable to expand task:",n.message)}finally{a()}},async selectTask({commit:e,dispatch:t},s){e("selectTask",s),await t("saveSelectedTask")},async saveSelectedTask({state:e,dispatch:t}){await t("saveLocal",{name:"selected",value:e.selectedTask})}}}),Jt=Yt;k.Ay.config.productionTip=!1,new k.Ay({router:pt,store:Jt,vuetify:re,i18n:He,render:e=>e(qe)}).$mount("#app")}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a].call(r.exports,r,r.exports,s),r.exports}s.m=e,(()=>{var e=[];s.O=(t,a,n,r)=>{if(!a){var i=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],r=e[c][2];for(var o=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(s.O).every(e=>s.O[e](a[l]))?a.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(c--,1);var d=n();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[a,n,r]}})(),(()=>{s.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return s.d(t,{a:t}),t}})(),(()=>{s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};s.O.j=t=>0===e[t];var t=(t,a)=>{var n,r,i=a[0],o=a[1],l=a[2],d=0;if(i.some(t=>0!==e[t])){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var c=l(s)}for(t&&t(a);d<i.length;d++)r=i[d],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(c)},a=self["webpackChunkgestalt"]=self["webpackChunkgestalt"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=s.O(void 0,[504],()=>s(9965));a=s.O(a)})();